const Shell = require( 'WScript.Shell' )
const { join } = require( 'pathname' )
const cd = Shell.CurrentDirectory
const fso = require( 'Scripting.FileSystemObject' )

function install ( name ) {
    if ( !name.includes( '@' ) ) throw new Error( 'Module specification method must be "author@repository"' )

    const node_modules = join( cd, 'node_modules' )
    if( !fso.FolderExists( node_modules ) ) fso.CreateFolder( node_modules )

    const [ author, repository ] = name.split( '@' )
    Shell.Run( `bitsadmin /TRANSFER GetWES https://raw.githubusercontent.com/${ author }/${ repository }/master/${ repository }.json ${ node_modules }\\${ repository }.json`)
}
